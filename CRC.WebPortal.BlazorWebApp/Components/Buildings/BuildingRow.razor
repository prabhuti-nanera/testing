@using CRC.WebPortal.BlazorWebApp.Models

<div class="building-row">
    <div class="row g-3 align-items-center">
        <div class="col-md-4">
            <label class="form-label small">Building Name</label>
            <input type="text" class="form-control form-control-sm" 
                   @bind="localBuilding.Name" 
                   @bind:after="NotifyChange"
                   @onblur="NotifyChange"
                   placeholder="e.g., Block A" />
        </div>
        <div class="col-md-3">
            <label class="form-label small">Floors</label>
            <input type="number" class="form-control form-control-sm" 
                   @bind="localBuilding.Floors" 
                   @bind:after="NotifyChange"
                   @onblur="NotifyChange"
                   min="1" max="100" />
        </div>
        <div class="col-md-3">
            <label class="form-label small">Units per Floor</label>
            <input type="number" class="form-control form-control-sm" 
                   @bind="localBuilding.UnitsPerFloor" 
                   @bind:after="NotifyChange"
                   @onblur="NotifyChange"
                   min="1" max="50" />
        </div>
        <div class="col-md-2">
            <label class="form-label small">Total Units</label>
            <div class="d-flex align-items-center gap-2">
                <div class="total-units flex-grow-1">@(localBuilding.Floors * localBuilding.UnitsPerFloor)</div>
                <button type="button" class="btn btn-outline-danger btn-sm delete-btn-small" 
                        @onclick="OnDelete" title="Delete Building">
                    <i class="fas fa-trash-alt"></i>
                </button>
            </div>
        </div>
    </div>
</div>

@code {
    [Parameter] public CreateBuildingRequest Building { get; set; } = new();
    [Parameter] public EventCallback<CreateBuildingRequest> BuildingChanged { get; set; }
    [Parameter] public EventCallback OnDelete { get; set; }

    private CreateBuildingRequest localBuilding = new();

    protected override void OnParametersSet()
    {
        localBuilding = new CreateBuildingRequest
        {
            Name = Building.Name,
            Type = Building.Type,
            Floors = Building.Floors,
            UnitsPerFloor = Building.UnitsPerFloor
        };
    }

    private async Task NotifyChange()
    {
        await BuildingChanged.InvokeAsync(localBuilding);
    }
}

<style>
    .building-row {
        padding: 15px;
        border: 1px solid #e9ecef;
        border-radius: 6px;
        background-color: #f8f9fa;
    }

    .building-row:hover {
        border-color: #007bff;
        background-color: #f0f8ff;
    }

    .total-units {
        font-weight: 600;
        color: #007bff;
        font-size: 1.1em;
        text-align: center;
        padding: 6px;
        background-color: #e7f3ff;
        border-radius: 4px;
        border: 1px solid #b3d9ff;
    }

    .form-label.small {
        font-size: 0.875rem;
        font-weight: 500;
        color: #495057;
        margin-bottom: 4px;
    }

    .delete-btn-small {
        padding: 2px 4px;
        font-size: 0.7rem;
        min-width: 24px;
        min-height: 24px;
        display: flex;
        align-items: center;
        justify-content: center;
    }

    .delete-btn-small:hover {
        transform: scale(1.05);
        background-color: #dc3545 !important;
        color: white !important;
        border-color: #dc3545 !important;
    }
</style>
